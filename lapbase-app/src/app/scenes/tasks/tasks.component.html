<div class="columns is-mobile">
  <div class="column is-12 has-text-centered">
    <h1 class="title ">
      <a class="button is-medium-tablet is-small-mobile is-pulled-left" (click)="changeDate(false)">
        <span class="icon is-medium">
          <i class="fas fa-chevron-left fa-2x"></i>
        </span>
      </a>
      {{ date | date: "yyyy-MM-dd" }}
      <a class="button is-medium-tablet is-small-mobile is-pulled-right" (click)="changeDate(true)">
        <span class="icon is-medium">
          <i class="fas fa-chevron-right fa-2x"></i>
        </span>
      </a>
    </h1>
  </div>
</div>

<div class="tabs is-toggle is-toggle-rounded is-centered  is-fullwidth">
  <ul>
    <li [ngClass]="{ 'is-active': foodActive }">
      <a (click)="changeFoodExercises()">Food</a>
    </li>
    <li [ngClass]="{ 'is-active': !foodActive }">
      <a (click)="changeFoodExercises()">Exercises</a>
    </li>
  </ul>
</div>

<div [class.is-hidden]="foodFlag">
  <!-- Food entry below this point -->

  <div class="columns is-mobile">
    <div class="column is-12">
      <h2 class="subtitle">
        Breakfast
        <a class="button is-pulled-right" (click)="toggleModal(0)"
          >Add Breakfast
        </a>
      </h2>
    </div>
  </div>
  <table class="table is-fullwidth is-striped is-hoverable" *ngIf="getMeal(0).length > 0">
    <thead>
      <tr>
        <th>Food</th>
        <th>Cal</th>
        <th>Quantity</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let food of getMeal(0)">
        <td>
          <a class="button is-small" (click)="removeFood(0, food.id)">
            <span class="icon is-small">
              <i class="fas fa-trash-alt"></i>
            </span>
          </a>
          {{ (getFoodInfo(food.id) && getFoodInfo(food.id).name) || "" }}
        </td>
        <td>
          {{
            (getFoodInfo(food.id) && getFoodInfo(food.id).calorieCount) || ""
          }}
        </td>
        <td>
          <a
            class="button is-small"
            (click)="changeQuantity(0, food.id, false)"
          >
            <span class="icon is-small">
              <i class="fas fa-minus"></i>
            </span>
          </a>
          {{ food.quantity }}
          <a class="button is-small" (click)="changeQuantity(0, food.id, true)">
            <span class="icon is-small">
              <i class="fas fa-plus"></i>
            </span>
          </a>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="columns is-mobile">
    <div class="column is-12">
      <h2 class="subtitle">
        Lunch
        <a class="button is-pulled-right" (click)="toggleModal(1)"
          >Add Lunch
        </a>
      </h2>
    </div>
  </div>
  <table class="table is-fullwidth is-striped is-hoverable" *ngIf="getMeal(1).length > 0">
    <thead>
      <tr>
        <th>Food</th>
        <th>Cal</th>
        <th>Quantity</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let food of getMeal(1)">
        <td>
          <a class="button is-small" (click)="removeFood(1, food.id)">
            <span class="icon is-small">
              <i class="fas fa-trash-alt"></i>
            </span>
          </a>
          {{ (getFoodInfo(food.id) && getFoodInfo(food.id).name) || "" }}
        </td>
        <td>
          {{
            (getFoodInfo(food.id) && getFoodInfo(food.id).calorieCount) || ""
          }}
        </td>
        <td>
          <a
            class="button is-small"
            (click)="changeQuantity(1, food.id, false)"
          >
            <span class="icon is-small">
              <i class="fas fa-minus"></i>
            </span>
          </a>
          {{ food.quantity }}
          <a class="button is-small" (click)="changeQuantity(1, food.id, true)">
            <span class="icon is-small">
              <i class="fas fa-plus"></i>
            </span>
          </a>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="columns is-mobile">
    <div class="column is-12">
      <h2 class="subtitle">
        Dinner
        <a class="button is-pulled-right" (click)="toggleModal(2)"
          >Add Dinner
        </a>
      </h2>
    </div>
  </div>
  <table class="table is-fullwidth is-striped is-hoverable" *ngIf="getMeal(2).length > 0">
    <thead>
      <tr>
        <th>Food</th>
        <th>Cal</th>
        <th>Quantity</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let food of getMeal(2)">
        <td>
          <a class="button is-small" (click)="removeFood(2, food.id)">
            <span class="icon is-small">
              <i class="fas fa-trash-alt"></i>
            </span>
          </a>
          {{ (getFoodInfo(food.id) && getFoodInfo(food.id).name) || "" }}
        </td>
        <td>
          {{
            (getFoodInfo(food.id) && getFoodInfo(food.id).calorieCount) || ""
          }}
        </td>
        <td>
          <a
            class="button is-small"
            (click)="changeQuantity(2, food.id, false)"
          >
            <span class="icon is-small">
              <i class="fas fa-minus"></i>
            </span>
          </a>
          {{ food.quantity }}
          <a class="button is-small" (click)="changeQuantity(2, food.id, true)">
            <span class="icon is-small">
              <i class="fas fa-plus"></i>
            </span>
          </a>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div [class.is-hidden]="!foodFlag">
  <div class="columns is-mobile">
    <div class="column is-12">
      <h2 class="subtitle">
        <a class="button is-pulled-right" (click)="toggleExercises()">
          Add Exercises
        </a>
      </h2>
    </div>
  </div>
  <table class="table is-fullwidth is-striped is-hoverable">
    <thead>
      <tr>
        <th>Exercises</th>
        <th>Cal</th>
        <th>Reps</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let exercise of getExercises()">
        <td>
          <a class="button is-small" (click)="removeExercise(exercise.id)">
            <span class="icon is-small">
              <i class="fas fa-trash-alt"></i>
            </span>
          </a>
          {{
            (getExerciseInfo(exercise.id) &&
              getExerciseInfo(exercise.id).name) ||
              ""
          }}
        </td>
        <td>
          {{
            (getExerciseInfo(exercise.id) &&
              getExerciseInfo(exercise.id).calorieCount) ||
              ""
          }}
        </td>
        <td>
          <a class="button is-small" (click)="changeReps(exercise.id, false)">
            <span class="icon is-small">
              <i class="fas fa-minus"></i>
            </span>
          </a>
          {{ exercise.quantity }}
          <a class="button is-small" (click)="changeReps(exercise.id, true)">
            <span class="icon is-small">
              <i class="fas fa-plus"></i>
            </span>
          </a>
        </td>
      </tr>
    </tbody>
  </table>
</div>

<div class="field is-horizontal">
  <div class="manual-inputs">
    <div class="field-body">
      <div class="field">
        <label class="label">Calories Intake: </label>
        <input type="number" class="input" [(ngModel)]="totalCalories" />
      </div>
      <div class="field">
        <label class="label">Calories Burned: </label>
        <input type="number" class="input" [(ngModel)]="totalCaloriesBurned" />
      </div>
      <div class="field">
        <label class="label">Weight</label>
        <input type="number" class="input" placeholder="kg" />
      </div>
    </div>
  </div>
</div>

<a (click)="save()" class="button is-success is-pulled-right">Save</a>

<div
  class="modal"
  [ngClass]="modalClass()"
  *ngIf="selectedMealTime !== undefined"
>
  <div class="modal-background" (click)="toggleModal()"></div>
  <div class="modal-content">
    <app-food-choices
      [selectedFoods]="getMeal(selectedMealTime)"
      [availableFoodChoices]="availableFoodChoices"
      [totalCalories]="totalCalories"
      (increaseCalorie)="updateCalories($event)"
      (decreaseCalorie)="updateCalories($event)"
    ></app-food-choices>
  </div>
  <button
    class="modal-close is-large"
    aria-label="close"
    (click)="toggleModal()"
  ></button>
</div>

<div class="modal" [ngClass]="exerciseModalClass()">
  <div class="modal-background" (click)="toggleExercises()"></div>
  <div class="modal-content">
    <app-exercise-choices
      [selectedExercises]="getExercises()"
      [availableExerciseChoices]="availableExerciseChoices"
      [totalCaloriesBurned]="totalCaloriesBurned"
      (increaseCalorieBurned)="updateCaloriesBurned($event)"
      (decreaseCalorieBurned)="updateCaloriesBurned($event)"
    ></app-exercise-choices>
  </div>
  <button
    class="modal-close is-large"
    aria-label="close"
    (click)="toggleExercises()"
  ></button>
</div>
